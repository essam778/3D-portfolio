import{k as w,r as e,l as j,D as d,n as M,V as S,j as u,o as C}from"./index-DCTAk8c4.js";import{_ as m,u as h,C as U,P as F}from"./Preload-CRDg0bA7.js";const I=()=>parseInt(w.replace(/\D+/g,"")),v=I(),b=v>=154?"opaque_fragment":"output_fragment";class z extends j{constructor(r){super(r),this.onBeforeCompile=(t,a)=>{const{isWebGL2:o}=a.capabilities;t.fragmentShader=t.fragmentShader.replace(`#include <${b}>`,`
        ${o?`#include <${b}>`:`#extension GL_OES_standard_derivatives : enable
#include <${b}>`}
      vec2 cxy = 2.0 * gl_PointCoord - 1.0;
      float r = dot(cxy, cxy);
      float delta = fwidth(r);     
      float mask = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);
      gl_FragColor = vec4(gl_FragColor.rgb, mask * gl_FragColor.a );
      #include <tonemapping_fragment>
      #include <${v>=154?"colorspace_fragment":"encodings_fragment"}>
      `)}}}const W=e.forwardRef((s,r)=>{const[t]=e.useState(()=>new z(null));return e.createElement("primitive",m({},s,{object:t,ref:r,attach:"material"}))});let i,p;const D=e.createContext(null),A=new M,_=new S,N=e.forwardRef(({children:s,range:r,limit:t=1e3,...a},o)=>{const n=e.useRef(null);e.useImperativeHandle(o,()=>n.current,[]);const[c,l]=e.useState([]),[[f,x,y]]=e.useState(()=>[new Float32Array(t*3),Float32Array.from({length:t*3},()=>1),Float32Array.from({length:t},()=>1)]);e.useEffect(()=>{n.current.geometry.attributes.position.needsUpdate=!0}),h(()=>{for(n.current.updateMatrix(),n.current.updateMatrixWorld(),A.copy(n.current.matrixWorld).invert(),n.current.geometry.drawRange.count=Math.min(t,r!==void 0?r:t,c.length),i=0;i<c.length;i++)p=c[i].current,p.getWorldPosition(_).applyMatrix4(A),_.toArray(f,i*3),n.current.geometry.attributes.position.needsUpdate=!0,p.matrixWorldNeedsUpdate=!0,p.color.toArray(x,i*3),n.current.geometry.attributes.color.needsUpdate=!0,y.set([p.size],i),n.current.geometry.attributes.size.needsUpdate=!0});const P=e.useMemo(()=>({getParent:()=>n,subscribe:E=>(l(g=>[...g,E]),()=>l(g=>g.filter(R=>R.current!==E.current)))}),[]);return e.createElement("points",m({userData:{instances:c},matrixAutoUpdate:!1,ref:n,raycast:()=>null},a),e.createElement("bufferGeometry",null,e.createElement("bufferAttribute",{attach:"attributes-position",args:[f,3],usage:d}),e.createElement("bufferAttribute",{attach:"attributes-color",args:[x,3],usage:d}),e.createElement("bufferAttribute",{attach:"attributes-size",args:[y,1],usage:d})),e.createElement(D.Provider,{value:P},s))}),$=e.forwardRef(({children:s,positions:r,colors:t,sizes:a,stride:o=3,...n},c)=>{const l=e.useRef(null);return e.useImperativeHandle(c,()=>l.current,[]),h(()=>{const f=l.current.geometry.attributes;f.position.needsUpdate=!0,t&&(f.color.needsUpdate=!0),a&&(f.size.needsUpdate=!0)}),e.createElement("points",m({ref:l},n),e.createElement("bufferGeometry",null,e.createElement("bufferAttribute",{attach:"attributes-position",args:[r,o],usage:d}),t&&e.createElement("bufferAttribute",{attach:"attributes-color",args:[t,o],count:t.length/o,usage:d}),a&&e.createElement("bufferAttribute",{attach:"attributes-size",args:[a,1],count:a.length/o,usage:d})),s)}),k=e.forwardRef((s,r)=>s.positions instanceof Float32Array?e.createElement($,m({},s,{ref:r})):e.createElement(N,m({},s,{ref:r}))),G=s=>{const r=e.useRef(),t=C(new Float32Array(5e3),{radius:1.2});for(let a=0;a<t.length;a++)isNaN(t[a])&&(t[a]=0);return h((a,o)=>{r.current.rotation.x-=o/10,r.current.rotation.y-=o/15}),u.jsx("group",{rotation:[0,0,Math.PI/4],children:u.jsx(k,{ref:r,positions:t,stride:3,frustumCulled:!0,...s,children:u.jsx(W,{transparent:!0,color:"#f272c8",size:.002,sizeAttenuation:!0,depthWrite:!1})})})},B=()=>u.jsx("div",{className:"w-full h-full absolute inset-0 z-[-1]",children:u.jsxs(U,{camera:{position:[0,0,1]},children:[u.jsx(e.Suspense,{fallback:null,children:u.jsx(G,{})}),u.jsx(F,{all:!0})]})});export{B as default};
